<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes"/>
    <title>打靶供束时间修正</title>
    <link rel="stylesheet" type="text/css" href="styles/iview.css">
    <script src="vue.min.js"></script>
    <script type="text/javascript" src="iview.min.js"></script>
    <script type="text/javascript" src="moment.min.js"></script>
    <script src="axios.min.js"></script>
    <script src="echarts.min.js"></script>
</head>
<body style="width:100%;">
<style>

#title{
  font-size:20px;
  font-family:verdana;
  text-align:center;
  background-color:#F8F8FF;
  font-weight:bold;
}
#login_form{
	width:80%;
	margin:0 auto;
}
.mposition{
  /*font-size:20px;*/
  text-align:center;
  margin-top:4px;
  margin-bottom:4px;
}
#sbutton{
  width:60px;
  position:relative;
  /*left: 107px;*/
}
.minput{
  width:130px;
  height:20px;
}
</style>
<div align="center">
	<img width="100%" height="55" src="logo.png"/>
</div>
<p id="title">打靶供束时间修正</p>
<br>
<div id="app" style="position:relative;top:-8px;">
<form action="modify_server.php" method="post" id="login_form">
	<fieldset>
		<legend class="mtext">数据修正</legend>
				<br>
				<p class="mposition"><label> 日  期: </label><input v-model="sdate" type="date" name="sdate" class="minput" id="datePicker"></p>
				<p class="mposition"><label>原始值:{{rawdata}} </label><label> , 最新值:{{latestdata}}</label></p>
				<p class="mposition" id="pass"><label>修正值:</label><input type="text" name="newdata" class="minput"></p>
				<p class="mposition"><label> </label><input id="sbutton" type="submit" name="modify" value="提交"></p>
				<br>
	</fieldset>
</form>	
</div>

<script>
var today=moment().format('YYYY-MM-DD');
document.getElementById("datePicker").value = today;
	
    var Main = {
        data () {
            return {
                sdate:today,
                rawdata:'',
                latestdata: ''
            }
       },
     	  mounted() {
     	  	var self = this;
          axios.get('./modify_getdata.php', {//初始化时请求一次数据
				    params: {
				    	sdate: today
				    }
				  })
				  .then(function (response) {
				    console.log(response);
				    self.latestdata=response.data[0];
				    self.rawdata=response.data[1];
				  })
				  .catch(function (error) {
				    console.log(error);
				  });
  			},
	      methods: {
	  		},
	  		watch:{
          sdate:function(val) {
          	var self = this;
            axios.get('./modify_getdata.php', {//输入框数据变化时请求数据
					    params: {
					    	sdate: val
					    }
					  })
					  .then(function (response) {
					    console.log(response);
					    self.latestdata=response.data[0];
					    self.rawdata=response.data[1];
					  })
					  .catch(function (error) {
					    console.log(error);
					  });
          }
      	}
    }

var Component = Vue.extend(Main)
new Component().$mount('#app')

</script>

</body>
</html>
